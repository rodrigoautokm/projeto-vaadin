{
  "version": 3,
  "sources": ["../../@vaadin/grid/src/vaadin-grid-active-item-mixin.js"],
  "sourcesContent": ["/**\n * @license\n * Copyright (c) 2016 - 2022 Vaadin Ltd.\n * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n */\n\n/**\n * @polymerMixin\n */\nexport const ActiveItemMixin = (superClass) =>\n  class ActiveItemMixin extends superClass {\n    static get properties() {\n      return {\n        /**\n         * The item user has last interacted with. Turns to `null` after user deactivates\n         * the item by re-interacting with the currently active item.\n         * @type {GridItem}\n         */\n        activeItem: {\n          type: Object,\n          notify: true,\n          value: null,\n        },\n      };\n    }\n\n    /** @protected */\n    ready() {\n      super.ready();\n\n      this.$.scroller.addEventListener('click', this._onClick.bind(this));\n      this.addEventListener('cell-activate', this._activateItem.bind(this));\n      this.addEventListener('row-activate', this._activateItem.bind(this));\n    }\n\n    /** @private */\n    _activateItem(e) {\n      const model = e.detail.model;\n      const clickedItem = model ? model.item : null;\n\n      if (clickedItem) {\n        this.activeItem = !this._itemsEqual(this.activeItem, clickedItem) ? clickedItem : null;\n      }\n    }\n\n    /**\n     * We need to listen to click instead of tap because on mobile safari, the\n     * document.activeElement has not been updated (focus has not been shifted)\n     * yet at the point when tap event is being executed.\n     * @param {!MouseEvent} e\n     * @protected\n     */\n    _onClick(e) {\n      if (e.defaultPrevented) {\n        // Something has handled this click already, e. g., <vaadin-grid-sorter>\n        return;\n      }\n\n      const path = e.composedPath();\n      const cell = path[path.indexOf(this.$.table) - 3];\n      if (!cell || cell.getAttribute('part').indexOf('details-cell') > -1) {\n        return;\n      }\n      const cellContent = cell._content;\n\n      const activeElement = this.getRootNode().activeElement;\n      const cellContentHasFocus = cellContent.contains(activeElement);\n      if (!cellContentHasFocus && !this._isFocusable(e.target)) {\n        this.dispatchEvent(\n          new CustomEvent('cell-activate', {\n            detail: {\n              model: this.__getRowModel(cell.parentElement),\n            },\n          }),\n        );\n      }\n    }\n\n    /**\n     * @param {!Element} target\n     * @return {boolean}\n     * @protected\n     */\n    _isFocusable(target) {\n      return isFocusable(target);\n    }\n\n    /**\n     * Fired when the `activeItem` property changes.\n     *\n     * @event active-item-changed\n     */\n\n    /**\n     * Fired when the cell is activated with click or keyboard.\n     *\n     * @event cell-activate\n     */\n  };\n\n/**\n * @param {!Element} target\n * @return {boolean}\n * @protected\n */\nexport const isFocusable = (target) => {\n  if (!target.parentNode) {\n    return false;\n  }\n  const focusables = Array.from(\n    target.parentNode.querySelectorAll(\n      '[tabindex], button, input, select, textarea, object, iframe, label, a[href], area[href]',\n    ),\n  ).filter((element) => element.getAttribute('part') !== 'cell body-cell');\n\n  const isFocusableElement = focusables.includes(target);\n  return !target.disabled && isFocusableElement;\n};\n"],
  "mappings": ";AASO,IAAM,kBAAkB,CAAC,eAC9B,MAAM,wBAAwB,WAAW;AAAA,EACvC,WAAW,aAAa;AACtB,WAAO;AAAA,MAML,YAAY;AAAA,QACV,MAAM;AAAA,QACN,QAAQ;AAAA,QACR,OAAO;AAAA,MACT;AAAA,IACF;AAAA,EACF;AAAA,EAGA,QAAQ;AACN,UAAM,MAAM;AAEZ,SAAK,EAAE,SAAS,iBAAiB,SAAS,KAAK,SAAS,KAAK,IAAI,CAAC;AAClE,SAAK,iBAAiB,iBAAiB,KAAK,cAAc,KAAK,IAAI,CAAC;AACpE,SAAK,iBAAiB,gBAAgB,KAAK,cAAc,KAAK,IAAI,CAAC;AAAA,EACrE;AAAA,EAGA,cAAc,GAAG;AACf,UAAM,QAAQ,EAAE,OAAO;AACvB,UAAM,cAAc,QAAQ,MAAM,OAAO;AAEzC,QAAI,aAAa;AACf,WAAK,aAAa,CAAC,KAAK,YAAY,KAAK,YAAY,WAAW,IAAI,cAAc;AAAA,IACpF;AAAA,EACF;AAAA,EASA,SAAS,GAAG;AACV,QAAI,EAAE,kBAAkB;AAEtB;AAAA,IACF;AAEA,UAAM,OAAO,EAAE,aAAa;AAC5B,UAAM,OAAO,KAAK,KAAK,QAAQ,KAAK,EAAE,KAAK,IAAI;AAC/C,QAAI,CAAC,QAAQ,KAAK,aAAa,MAAM,EAAE,QAAQ,cAAc,IAAI,IAAI;AACnE;AAAA,IACF;AACA,UAAM,cAAc,KAAK;AAEzB,UAAM,gBAAgB,KAAK,YAAY,EAAE;AACzC,UAAM,sBAAsB,YAAY,SAAS,aAAa;AAC9D,QAAI,CAAC,uBAAuB,CAAC,KAAK,aAAa,EAAE,MAAM,GAAG;AACxD,WAAK;AAAA,QACH,IAAI,YAAY,iBAAiB;AAAA,UAC/B,QAAQ;AAAA,YACN,OAAO,KAAK,cAAc,KAAK,aAAa;AAAA,UAC9C;AAAA,QACF,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAAA,EAOA,aAAa,QAAQ;AACnB,WAAO,YAAY,MAAM;AAAA,EAC3B;AAaF;AAOK,IAAM,cAAc,CAAC,WAAW;AACrC,MAAI,CAAC,OAAO,YAAY;AACtB,WAAO;AAAA,EACT;AACA,QAAM,aAAa,MAAM;AAAA,IACvB,OAAO,WAAW;AAAA,MAChB;AAAA,IACF;AAAA,EACF,EAAE,OAAO,CAAC,YAAY,QAAQ,aAAa,MAAM,MAAM,gBAAgB;AAEvE,QAAM,qBAAqB,WAAW,SAAS,MAAM;AACrD,SAAO,CAAC,OAAO,YAAY;AAC7B;",
  "names": []
}
